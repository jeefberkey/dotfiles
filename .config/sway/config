# sway config file (v4)
# vim: ft=sh
# Please see http://i3wm.org/docs/userguide.html for a complete reference!

# set modifier, this in the windows key
set $mod Mod4

# ================
# ==== colors ====
# ================

# import from wal
include "$HOME/.cache/wal/colors-sway"

# ==================
# ==== settings ====
# ==================

# font
font pango:Roboto Condensed, FontAwesome 11

# window focus follows mouse
focus_follows_mouse yes

# automatically go back to the previous workspace
workspace_auto_back_and_forth yes

floating_modifier $mod

# # fix popups, specifically for hangouts
# for_window [window_role="pop-up"] floating enable
# for_window [window_role="bubble"] floating enable
# for_window [window_role="task_dialog"] floating enable
# for_window [window_role="Preferences"] floating enable

for_window [class="(?i)VirtualBox" title="(?i)Manager"] floating enable
for_window [class="(?i)VirtualBox" title="(?i)Oracle VM VirtualBox"] floating enable
for_window [class="Nautilus" ] floating enable
for_window [class="Rofi" ] floating enable

# turns off gaps and borders when there's only one window
smart_borders on
smart_gaps on
hide_edge_borders smart

#for_window [class="^.*"] border pixel 2
default_border pixel
gaps inner 3
#gaps edge_gaps on

# ==================
# ==== keybinds ====
# ==================

# kill focused window
bindsym $mod+Shift+q kill

# change focus
bindsym $mod+h focus left
bindsym $mod+j focus down
bindsym $mod+k focus up
bindsym $mod+l focus right

# alternatively, you can use the cursor keys:
bindsym $mod+Left focus left
bindsym $mod+Down focus down
bindsym $mod+Up focus up
bindsym $mod+Right focus right

# move focused window
bindsym $mod+Shift+h move left
bindsym $mod+Shift+j move down
bindsym $mod+Shift+k move up
bindsym $mod+Shift+l move right

# alternatively, you can use the cursor keys:
bindsym $mod+Shift+Left move left
bindsym $mod+Shift+Down move down
bindsym $mod+Shift+Up move up
bindsym $mod+Shift+Right move right

# split in horizontal and vertical orientation
bindsym $mod+b split h
bindsym $mod+v split v
bindsym $mod+s split toggle

# enter fullscreen mode for the focused container
bindsym $mod+f fullscreen toggle

# change container layout (stacked, tabbed, toggle split)
#bindsym $mod+s layout stacking
#bindsym $mod+w layout tabbed

# toggle tiling / floating
bindsym $mod+Shift+space floating toggle

## change focus between tiling / floating windows
bindsym $mod+t focus mode_toggle

# focus the parent container
#bindsym $mod+a focus parent

# focus the child container
#bindsym $mod+d focus child

# restart sway inplace (preserves your layout/session)
bindsym $mod+Shift+r reload
# exit sway (logs you out of your session)
bindsym $mod+Shift+e exec "swaynag -t warning -m 'You pressed the exit shortcut. Do you really want to exit sway? This will end your X session.' -b 'Yes, exit sway' 'swaymsg exit'"

# move workspaces between monitors
bindsym $mod+Mod1+Left move workspace to output left
bindsym $mod+Mod1+Right move workspace to output right

# switch to workspace
bindsym $mod+1 workspace 1
bindsym $mod+2 workspace 2
bindsym $mod+3 workspace 3
bindsym $mod+4 workspace 4
bindsym $mod+5 workspace 5
bindsym $mod+6 workspace 6
bindsym $mod+7 workspace 7
bindsym $mod+8 workspace 8
bindsym $mod+9 workspace 9
bindsym $mod+0 workspace 10

# move focused container to workspace
bindsym $mod+Shift+1 move container to workspace 1
bindsym $mod+Shift+2 move container to workspace 2
bindsym $mod+Shift+3 move container to workspace 3
bindsym $mod+Shift+4 move container to workspace 4
bindsym $mod+Shift+5 move container to workspace 5
bindsym $mod+Shift+6 move container to workspace 6
bindsym $mod+Shift+7 move container to workspace 7
bindsym $mod+Shift+8 move container to workspace 8
bindsym $mod+Shift+9 move container to workspace 9
bindsym $mod+Shift+0 move container to workspace 10

# ==================
# ==== keybinds ====
# ==================

# terminal emulator
bindsym $mod+Return exec gnome-terminal

# file manager
bindsym $mod+Shift+f exec nautilus

# a rofi (a program launcher)
# https://davedavenport.github.io/rofi/generator.html
bindsym $mod+d exec --no-startup-id /usr/bin/rofi -show combi
#bindsym $mod+d exec --no-startup-id "dmenu_run"
# program switcher
bindsym $mod+Tab exec --no-startup-id "rofi -show window"

# lock and suspend button
bindsym $mod+Shift+s exec swaylock && systemctl suspend
# lock
bindsym Control+Mod1+l exec swaylock

# dpms
# lock after 10 mins
# turn screen off after 15 mins
# lock screen before going to sleep
exec swayidle \
    timeout 600 'swaylock' \
    timeout 900 'swaymsg "output * dpms off"' \
       resume 'swaymsg "output * dpms on"' \
    before-sleep 'swaylock'

# none of these work in Spotify anyway
set $update && pkill -SIGRTMIN+10 i3status
bindsym XF86AudioPrev         exec --no-startup-id playerctl prev
bindsym XF86AudioPlay         exec --no-startup-id playerctl play-pause
bindsym XF86AudioNext         exec --no-startup-id playerctl next
bindsym XF86AudioLowerVolume  exec --no-startup-id amixer -q sset Master 3%- $update
bindsym XF86AudioRaiseVolume  exec --no-startup-id amixer -q sset Master 3%+ $update
bindsym XF86AudioMute         exec --no-startup-id amixer -q sset Master toggle $update
bindsym XF86MonBrightnessDown exec --no-startup-id light -U 10
bindsym XF86MonBrightnessUp   exec --no-startup-id light -A 5

# ================
# ==== resize ====
# ================
mode "resize" {
  bindsym h resize shrink width  10 px or 5 ppt
  bindsym j resize grow   height 10 px or 5 ppt
  bindsym k resize shrink height 10 px or 5 ppt
  bindsym l resize grow   width  10 px or 5 ppt

  bindsym Left  resize shrink width  10 px or 5 ppt
  bindsym Up    resize grow   height 10 px or 5 ppt
  bindsym Down  resize shrink height 10 px or 5 ppt
  bindsym Right resize grow   width  10 px or 5 ppt

  # back to normal: Enter or Escape
  bindsym Return mode "default"
  bindsym Escape mode "default"
}
bindsym $mod+r mode "resize"

# =============
# ==== bar ====
# =============
bar {
  # commands
  position top
  separator_symbol |
  #height 28
  pango_markup enabled
  font Roboto Condensed, FontAwesome 10

  #swaybar_command swaybar
  swaybar_command waybar
  #status_command i3blocks

  # TODO not available yet
  # # mouse wheel scrolls on the bar
  # bindsym button4 workspace prev
  # bindsym button5 workspace next
  wrap_scroll yes
}

# =================
# ==== startup ====
# =================

# network manager
exec nm-applet

# notifiation deamon
exec mako

# unlock keyring please
exec gnome-keyring-daemon --start

# wallpaper
# https://github.com/dylanaraps/pywal/wiki/Customization#sway
output * background $wallpaper stretch
client.focused $color0 $background $foreground $color7 $color0


# ================
# ==== inputs ====
# ================
# touchscreen
input 1267:8400:ELAN_Touchscreen {
  events enabled
  map_to_output eDP-1
}

# touchpad
input 1739:30383:DLL075B:01_06CB:76AF_Touchpad {
  events enabled
  tap enabled
  dwt enabled
  middle_emulation enabled
  scroll_method two_finger
  click_method clickfinger
  # natural_scroll enabled
}

# =================
# ==== outputs ====
# =================
mouse_warping output

#output eDP-1 pos -1600 0 res 3200x1800
output eDP-1 res 3200x1800 pos 0 0
output eDP-1 scale 2
output DP-1 res 2560x1440 pos 1600 0
output DP-1 scale 1

# Include default sway config, like security settings
include /etc/sway/config.d/*

